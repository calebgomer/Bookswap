extends layout
block content
  .container
    .row
      .col-lg-12.col-md-11.well
        .col-md-6
          h3 Add a book
          form(action='/mybooks', role='form', method='post', onsubmit='return document.getElementById("newBookIsbn").value ? true : false;')
            input(type='hidden', name='_csrf', value=csrfToken)
            input(type='hidden', name='action', value='addBook')
            input.form-control(type='text', name='isbn', id='newBookIsbn', placeholder='Book ISBN Number')
            br
            select.form-control(name='newBookOwnership')
              option(value='buying') I want to buy this book
              option(value='selling') I want to sell this book
              option(value='own') I own this book (not selling or buying)
            br
            button.form-control.btn.btn-success(type='submit', name='submit') Add Book
        .col-md-6
          if school && school.textbookLookupUrl
            if school.name
              h3 #{school.name} Textbook Lookup
            else
              h3 Textbook Lookup
            p Don't know the ISBN numbers of your books? Look them up on you school's Textbook Lookup website.
            button.form-control.btn.btn-primary(type='button', onclick='window.open("#{school.textbookLookupUrl}");') Look Up Textbooks
          else
            h3 Add Textbook Lookup!
            p No one has added the textbook lookup website for your school. If you know what it is, please paste it here so everyone else at you school can use it too!
            form(action='/mybooks', role='form', method='post')
              input(type='hidden', name='_csrf', value=csrfToken)
              input(type='hidden', name='action', value='addTextbookLookupUrl')
              input.form-control(type='text', name='textbookLookupUrl', placeholder='Textbook Lookup URL')
              br
              button.form-control.btn.btn-success(type='submit', name='submit') Add Textbook Lookup
          .hidden-xs
            h3 Automatic Book Import
            p Drag the link below into your bookmarks bar. When you're at you school's textbook website and have found your books, press the bookmark to automatically add your books to your Book List here!
            p
              a(href="javascript:(function(){_isbn_script=document.createElement('script');_isbn_script.type='text/javascript';_isbn_script.src='http://book-swap.herokuapp.com/javascripts/isbnSnatcher.js';document.getElementsByTagName('head')[0].appendChild(_isbn_script);})();") Book Swap Import
              | &nbsp;&nbsp;&nbsp;
              span.glyphicon.glyphicon-arrow-left
              | &nbsp;Drag To Your Bookmarks Bar
  .row
    if books && books.length
      - var lastBookOwnership;
      each book in books
        if lastBookOwnership !== book.ownership
          br
          hr
          case book.ownership
            when 'own'
              h2.text-center-xs Books You Own
            when 'selling'
              h2.text-center-xs Books You're Selling
            when 'buying'
              h2.text-center-xs Books You're Buying
        hr
        - lastBookOwnership = book.ownership
        .container
          .book
            .row
              .col-md-2.col-sm-3.col-xs-12.text-center
                if book.image
                  img.img-rounded(src='#{book.image}')
              .col-md-10.col-sm-9.col-xs-12
                .row.text-center-xs
                  .title
                    h4 #{book.title}
                      br.visible-xs
                      small &nbsp;by #{book.authors}
                    p ISBN: #{book.isbn}
                br
                .row
                  form(action='/mybooks', role='form', method='post')
                    input(type='hidden', name='_csrf', value=csrfToken)
                    input(type='hidden', name='action', value='modifyBook')
                    input(type='hidden', name='isbn', value=book.isbn)
                    if book.ownership !== 'own'
                      .col-sm-4.col-xs-12
                        button.btn.btn-default.btn-block(type='submit', name='own', value='own') Move to Own
                        br.visible-xs
                    if book.ownership !== 'selling'
                      .col-sm-4.col-xs-12
                        button.btn.btn-default.btn-block(type='submit', name='selling', value='selling') Move to Selling
                        br.visible-xs
                    if book.ownership !== 'buying'
                      .col-sm-4.col-xs-12
                        button.btn.btn-default.btn-block(type='submit', name='buying', value='buying') Move to Buying
                        br.visible-xs
                    .col-sm-4.col-xs-12
                      button.btn.btn-danger.btn-block(type='submit', name='remove', value='remove') Remove
                      br.visible-xs
      br
    else
      h3 You don't have any books yet. Please add some books!
